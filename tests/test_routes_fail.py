import pytest
import json


# run for each touple in decorator
# @pytest.mark.parametrize("amount",[("2001"), ("893248723487"), ("3478534875")])
# def test_too_many_cve_fail(test_client, amount):
#     """
#     GIVEN get API call 
#     WHEN too many CVEs are requested
#     THEN check if the amount of CVEs is right
#     """
#     response = test_client.get(f'/cve?amount={amount}')
#     assert b"You've requested too many CVEs at once. Max is 2000." in response.data
    

@pytest.mark.parametrize("amount", [("542"), ("42343"), ("0")])
def test_missing_token(test_client, amount):
    response = test_client.get(f'/cve?amount={amount}')
    assert b"Token is missing" in response.data


@pytest.mark.parametrize("password", [("noNumberPassword"), ("a"), ("no spaces"), ("noCapital")])
def test_invalid_password(test_client, password):

    headers = {
        'Content-Type': 'application/json',
        'Accept': 'application/json'}
    data = {
        'username': "ValidUsername11",
        'password': password}

    # dumps - turn python object into a json string
    response = test_client.post('/user/register', data=json.dumps(data), headers=headers)
    assert response.status_code == 400


